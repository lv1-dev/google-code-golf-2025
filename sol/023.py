def p(d,u=0,e=enumerate):
 for*m,c in b" @",b"",b" !":
  if(f:={p+min(u:=u or{g<<5|m for g,t in e(d)for m,f in e(t)if f})for p in m+[0]})<u and p(d,u^f)or u==f:
   for t in f:d[t>>5][t&31]=c
   return d